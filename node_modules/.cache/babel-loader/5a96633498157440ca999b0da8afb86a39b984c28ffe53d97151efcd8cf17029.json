{"ast":null,"code":"import { ref } from \"vue\";\nimport axios from \"axios\";\nimport { useAuthStore } from \"@/stores/auth\"; // Sesuaikan path dengan lokasi store Anda\nimport EditProfileModal from \"@/components/EditProfileModal.vue\"; // Path ke modal edit\n\nexport default {\n  components: {\n    EditProfileModal\n  },\n  setup() {\n    const authStore = useAuthStore();\n    const username = ref(authStore.username); // Mengakses username dari state store\n    const userId = ref(authStore.userId); // Asumsi userId juga ada di authStore\n    const showEditModal = ref(false);\n    const openEditModal = () => {\n      showEditModal.value = true;\n    };\n    const updateProfile = async updatedProfile => {\n      try {\n        await axios.put(`http://103.164.54.252:8000/api/users/${userId.value}`, updatedProfile, {\n          headers: {\n            Authorization: `Bearer ${authStore.token}`\n          }\n        });\n        authStore.username = updatedProfile.username; // Update state store dengan data baru\n        username.value = updatedProfile.username; // Update local ref dengan data baru\n        showEditModal.value = false;\n        alert(\"Profile updated successfully!\");\n      } catch (error) {\n        console.error(\"Failed to update profile:\", error);\n        alert(\"Failed to update profile.\");\n      }\n    };\n    const deleteAccount = async () => {\n      const confirmation = confirm(\"Are you sure you want to delete your account?\");\n      if (confirmation) {\n        try {\n          await axios.delete(`http://103.164.54.252:8000/api/users/${userId.value}`, {\n            headers: {\n              Authorization: `Bearer ${authStore.token}`\n            }\n          });\n          authStore.logout(); // Log out user setelah menghapus akun\n          alert(\"Account deleted successfully!\");\n        } catch (error) {\n          console.error(\"Failed to delete account:\", error);\n          alert(\"Failed to delete account.\");\n        }\n      }\n    };\n    return {\n      username,\n      showEditModal,\n      openEditModal,\n      updateProfile,\n      deleteAccount\n    };\n  }\n};","map":{"version":3,"names":["ref","axios","useAuthStore","EditProfileModal","components","setup","authStore","username","userId","showEditModal","openEditModal","value","updateProfile","updatedProfile","put","headers","Authorization","token","alert","error","console","deleteAccount","confirmation","confirm","delete","logout"],"sources":["/Users/deolorensa/vue/tech--gamatecha/src/views/ProfileView.vue"],"sourcesContent":["<template>\n  <div class=\"p-6\">\n    <h1 class=\"text-2xl font-bold mb-4\">Profile</h1>\n    <div\n      class=\"bg-slate-600 h-60 rounded-2xl mb-4 flex items-center justify-center\"\n    >\n      <img\n        src=\"https://gamatecha.com/wp-content/uploads/2024/06/Horizontal-Putih-Merah0-2-980x166.png\"\n        alt=\"asd\"\n        class=\"w-[1000px] p-10 object-cover mb-4 rounded\"\n      />\n    </div>\n    <p>Username: {{ username }}</p>\n    <div class=\"mt-4 flex space-x-4\">\n      <button\n        @click=\"openEditModal\"\n        class=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700\"\n      >\n        Edit Profile\n      </button>\n      <button\n        @click=\"deleteAccount\"\n        class=\"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-700\"\n      >\n        Delete Account\n      </button>\n    </div>\n    <edit-profile-modal\n      v-if=\"showEditModal\"\n      :username=\"username\"\n      @close=\"showEditModal = false\"\n      @save=\"updateProfile\"\n    />\n  </div>\n</template>\n\n<script>\nimport { ref } from \"vue\";\nimport axios from \"axios\";\nimport { useAuthStore } from \"@/stores/auth\"; // Sesuaikan path dengan lokasi store Anda\nimport EditProfileModal from \"@/components/EditProfileModal.vue\"; // Path ke modal edit\n\nexport default {\n  components: {\n    EditProfileModal,\n  },\n  setup() {\n    const authStore = useAuthStore();\n    const username = ref(authStore.username); // Mengakses username dari state store\n    const userId = ref(authStore.userId); // Asumsi userId juga ada di authStore\n    const showEditModal = ref(false);\n\n    const openEditModal = () => {\n      showEditModal.value = true;\n    };\n\n    const updateProfile = async (updatedProfile) => {\n      try {\n        await axios.put(\n          `http://103.164.54.252:8000/api/users/${userId.value}`,\n          updatedProfile,\n          {\n            headers: {\n              Authorization: `Bearer ${authStore.token}`,\n            },\n          }\n        );\n        authStore.username = updatedProfile.username; // Update state store dengan data baru\n        username.value = updatedProfile.username; // Update local ref dengan data baru\n        showEditModal.value = false;\n        alert(\"Profile updated successfully!\");\n      } catch (error) {\n        console.error(\"Failed to update profile:\", error);\n        alert(\"Failed to update profile.\");\n      }\n    };\n\n    const deleteAccount = async () => {\n      const confirmation = confirm(\n        \"Are you sure you want to delete your account?\"\n      );\n      if (confirmation) {\n        try {\n          await axios.delete(\n            `http://103.164.54.252:8000/api/users/${userId.value}`,\n            {\n              headers: {\n                Authorization: `Bearer ${authStore.token}`,\n              },\n            }\n          );\n          authStore.logout(); // Log out user setelah menghapus akun\n          alert(\"Account deleted successfully!\");\n        } catch (error) {\n          console.error(\"Failed to delete account:\", error);\n          alert(\"Failed to delete account.\");\n        }\n      }\n    };\n\n    return {\n      username,\n      showEditModal,\n      openEditModal,\n      updateProfile,\n      deleteAccount,\n    };\n  },\n};\n</script>\n\n<style>\n/* CSS styling can be added here */\n</style>\n"],"mappings":"AAqCA,SAASA,GAAE,QAAS,KAAK;AACzB,OAAOC,KAAI,MAAO,OAAO;AACzB,SAASC,YAAW,QAAS,eAAe,EAAE;AAC9C,OAAOC,gBAAe,MAAO,mCAAmC,EAAE;;AAElE,eAAe;EACbC,UAAU,EAAE;IACVD;EACF,CAAC;EACDE,KAAKA,CAAA,EAAG;IACN,MAAMC,SAAQ,GAAIJ,YAAY,CAAC,CAAC;IAChC,MAAMK,QAAO,GAAIP,GAAG,CAACM,SAAS,CAACC,QAAQ,CAAC,EAAE;IAC1C,MAAMC,MAAK,GAAIR,GAAG,CAACM,SAAS,CAACE,MAAM,CAAC,EAAE;IACtC,MAAMC,aAAY,GAAIT,GAAG,CAAC,KAAK,CAAC;IAEhC,MAAMU,aAAY,GAAIA,CAAA,KAAM;MAC1BD,aAAa,CAACE,KAAI,GAAI,IAAI;IAC5B,CAAC;IAED,MAAMC,aAAY,GAAI,MAAOC,cAAc,IAAK;MAC9C,IAAI;QACF,MAAMZ,KAAK,CAACa,GAAG,CACb,wCAAwCN,MAAM,CAACG,KAAK,EAAE,EACtDE,cAAc,EACd;UACEE,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUV,SAAS,CAACW,KAAK;UAC1C;QACF,CACF,CAAC;QACDX,SAAS,CAACC,QAAO,GAAIM,cAAc,CAACN,QAAQ,EAAE;QAC9CA,QAAQ,CAACI,KAAI,GAAIE,cAAc,CAACN,QAAQ,EAAE;QAC1CE,aAAa,CAACE,KAAI,GAAI,KAAK;QAC3BO,KAAK,CAAC,+BAA+B,CAAC;MACxC,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjDD,KAAK,CAAC,2BAA2B,CAAC;MACpC;IACF,CAAC;IAED,MAAMG,aAAY,GAAI,MAAAA,CAAA,KAAY;MAChC,MAAMC,YAAW,GAAIC,OAAO,CAC1B,+CACF,CAAC;MACD,IAAID,YAAY,EAAE;QAChB,IAAI;UACF,MAAMrB,KAAK,CAACuB,MAAM,CAChB,wCAAwChB,MAAM,CAACG,KAAK,EAAE,EACtD;YACEI,OAAO,EAAE;cACPC,aAAa,EAAE,UAAUV,SAAS,CAACW,KAAK;YAC1C;UACF,CACF,CAAC;UACDX,SAAS,CAACmB,MAAM,CAAC,CAAC,EAAE;UACpBP,KAAK,CAAC,+BAA+B,CAAC;QACxC,EAAE,OAAOC,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;UACjDD,KAAK,CAAC,2BAA2B,CAAC;QACpC;MACF;IACF,CAAC;IAED,OAAO;MACLX,QAAQ;MACRE,aAAa;MACbC,aAAa;MACbE,aAAa;MACbS;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}